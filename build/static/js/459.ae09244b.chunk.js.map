{"version":3,"file":"static/js/459.ae09244b.chunk.js","mappings":"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","sources":["Pages/Login.js"],"sourcesContent":["\r\nimport \"../Css/auth.css\";\r\nimport { Link } from \"react-router-dom\";\r\nimport React, { useState } from 'react';\r\nimport axios from 'axios';\r\nimport DeviceDetector from 'device-detector-js';\r\nimport Toastify from \"toastify-js\";\r\nimport \"toastify-js/src/toastify.css\"; \r\nimport Modal from 'react-bootstrap/Modal';\r\nimport Button from 'react-bootstrap/Button';\r\nimport { API_URL } from \"../App\";\r\nfunction Login() {\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [error, setError] = useState('');\r\n  const [show, setShow] = useState(false);\r\n  const handleClose = () => setShow(false);\r\n  const handleShow = () => setShow(true);\r\n  // const getDeviceInfo = () => {\r\n  //   const deviceDetector = new DeviceDetector();\r\n  //   const userAgent = navigator.userAgent;\r\n  //   const device = deviceDetector.parse(userAgent);\r\n  \r\n  //   return {\r\n  //     deviceType: device.device.type || 'unknown',\r\n  //     os: device.os.name || 'unknown',\r\n  //     osVersion: device.os.version || 'unknown',\r\n  //     browser: device.client.name || 'unknown',\r\n  //     browserVersion: device.client.version || 'unknown',\r\n  //   };\r\n  // };\r\n  \r\n  const [modalMessage, setModalMessage] = useState('');\r\n  const getDeviceInfo = () => {\r\n    const deviceDetector = new DeviceDetector();\r\n    const userAgent = navigator.userAgent;\r\n    const device = deviceDetector.parse(userAgent);\r\n  \r\n    return {\r\n      deviceType: device.device.type || 'unknown',\r\n      os: device.os.name || 'unknown',\r\n      osVersion: device.os.version || 'unknown',\r\n      browser: device.client.name || 'unknown',\r\n      browserVersion: device.client.version || 'unknown',\r\n    };\r\n  };\r\n  \r\n  const handleAccept = async () => {\r\n    try {\r\n      const deviceInfo = getDeviceInfo();\r\n\r\n      const res = await axios.post(`${API_URL}/users/login`, {\r\n        email,\r\n        password,\r\n        deviceInfo,\r\n      });\r\n  \r\n      if (res.data.token) {\r\n        localStorage.setItem('auth', res.data.token);\r\n        localStorage.setItem('name', res.data.name);\r\n        localStorage.setItem('id', res.data.id);\r\n        localStorage.setItem('img', res.data.img);\r\n  \r\n        window.location.href = '/';\r\n      }\r\n    } catch (err) {\r\n      if (err.response && err.response.status === 403) {\r\n        setError('Login not allowed from this device');\r\n      } else {\r\n        setError(\"Invalid email or password\");\r\n      }\r\n      console.error('Login error:', err);\r\n    }\r\n    handleClose();\r\n  };\r\n  \r\n  const handleLogin = async (e) => {\r\n    e.preventDefault();\r\n  \r\n    const deviceInfo = getDeviceInfo(); // Generate device info  \r\n    try {\r\n      const res = await axios.post(`${API_URL}/users/login`, {\r\n        email,\r\n        password,\r\n        deviceInfo, // Send device info in the request\r\n      });\r\n  \r\n      if (res.data.token) {\r\n        localStorage.setItem('auth', res.data.token);\r\n        localStorage.setItem('name', res.data.name);\r\n        localStorage.setItem('id', res.data.id);\r\n        localStorage.setItem('img', res.data.img);\r\n  \r\n        window.location.href = '/';\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Login error:\", err);\r\n      if (err.response && err.response.status === 403) {\r\n        setError('Login not allowed from this device');\r\n      } else {\r\n        setError(\"Invalid email or password\");\r\n      }\r\n    }\r\n  };\r\n  \r\n  \r\n  // const handleAccept = async () => {\r\n  //   try {\r\n  //     // Perform the login process again since the user has accepted the modal\r\n  //     const deviceInfo = getDeviceInfo();\r\n  //     const res = await axios.post(`${API_URL}/users/login`, {\r\n  //       email,\r\n  //       password,\r\n  //       deviceInfo\r\n  //     });\r\n\r\n  //     if (res.data.token) {\r\n  //       localStorage.setItem('auth', res.data.token);\r\n  //       localStorage.setItem('name', res.data.name);\r\n  //       localStorage.setItem('id', res.data.id);\r\n  //       localStorage.setItem('img', res.data.img);\r\n\r\n  //       // Redirect to home page\r\n  //       window.location.href = '/';\r\n  //     }\r\n  //   } catch (err) {\r\n  //     if (err.response && err.response.status === 403) {\r\n  //       setError('تسجيل الدخول غير متاح على هذا الجهاز');\r\n  //     } else {\r\n  //       setError(\"البريد الالكتروني أو كلمة المرور غير صحيحة\");\r\n  //     }\r\n  //     console.error('Login error:', err);\r\n  //   }\r\n    \r\n  //   handleClose();\r\n  // };\r\n\r\n  // const handleLogin = async (e) => {\r\n  //   e.preventDefault();\r\n  //   const deviceInfo = getDeviceInfo();\r\n\r\n  //   // Capture device information\r\n  //   try {\r\n\r\n  //     const res = await axios.post(`${API_URL}/users/login`, {\r\n  //       email,\r\n  //       password,\r\n  //       deviceInfo  // Include the device information in the request\r\n  //     });\r\n     \r\n  //     if (res.data.message) {\r\n  //       setModalMessage(res.data.message);\r\n  //       handleShow();\r\n  //     } else if (res.data.token) {\r\n  //       localStorage.setItem('auth', res.data.token);\r\n  //       localStorage.setItem('name', res.data.name);\r\n  //       localStorage.setItem('id', res.data.id);\r\n  //       localStorage.setItem('img', res.data.img);\r\n\r\n  //       window.location.href = '/';\r\n  //     }\r\n  \r\n  //   } catch (err) {\r\n  //     if (err.response && err.response.status === 403) {\r\n  //       setError('تسجيل الدخول غير متاح على هذا الجهاز');\r\n  //     } \r\n    \r\n  //     else {\r\n  //       setError(\"البريد الالكتروني أو كلمة المرور غير صحيحة\");\r\n  //     }\r\n  //     console.error('Login error:', err);\r\n  //   }\r\n  // };\r\n  \r\n  return (\r\n    <>\r\n      <section className=\"margin_section\">\r\n        <div className=\"container text-center\">\r\n          <div className=\"row\">\r\n            <div className=\"col-lg-1\"></div>\r\n            <div className=\"col-lg-5 col-md-6 col-sm-12 box_purple_auth\">\r\n              <div className=\"\">\r\n                <div className=\"hello_logo_auth_cont\">\r\n                  <p className=\"hi_auth\">مرحباً بك</p>\r\n                  <img\r\n                    src={require(\"../assets/ba9ma2.png\")}\r\n                    alt=\"ba9ma logo\"\r\n                    className=\"img-fluid logo_auth\"\r\n                    loading=\"lazy\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <Link to=\"/signup\">\r\n                  <button type=\"button\" className=\"btn auth_btn\">\r\n                  إنشاء حساب\r\n                  </button>\r\n             </Link>\r\n                </div>\r\n              </div>{\" \"}\r\n            </div>\r\n            <div className=\"col-lg-5 col-md-6 col-sm-12 cont_input_auth \">\r\n              <div className=\"row m-5\">\r\n                <p className=\"title_of_input_auth\">البريد الالكتروني</p>\r\n                <input\r\n                  type=\"text\"\r\n                  className={`search_blog ${error && 'error_input'}`}\r\n                  value={email} onChange={(e) => setEmail(e.target.value)}\r\n                 \r\n                />\r\n                \r\n\r\n\r\n\r\n              </div>\r\n              <div className=\"row m-5\">\r\n                <p className=\"title_of_input_auth\">كلمة المرور</p>\r\n                <input\r\n                   type=\"password\"\r\n                   className={`search_blog ${error && 'error_input'}`}\r\n                  value={password} onChange={(e) => setPassword(e.target.value)}\r\n                \r\n                />\r\n              \r\n\r\n\r\n              <Link to=\"/forgotpassword\" className=\"forget_pass_auth\">نسيت كلمة المرور؟</Link>              </div>\r\n              {error && <p className=\"error_message\">{error}</p>}\r\n              <button type=\"button\" onClick={handleLogin} className=\"btn purple_btn mb-2\">تسجيل الدخول</button>\r\n\r\n            </div>\r\n            \r\n            <div className=\"col-lg-1\"></div>\r\n          </div>\r\n        </div>\r\n        <Modal show={show} onHide={handleClose}>\r\n        <Modal.Header >\r\n          <Modal.Title> تسجيل الدخول</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>{modalMessage}</Modal.Body>\r\n        <Modal.Footer>\r\n        \r\n          <Button style={{backgroundColor:\"#833988\",border:\"none\",textAlign:\"center\"}} onClick={handleAccept}>\r\nclose          </Button>\r\n        </Modal.Footer>\r\n      </Modal>\r\n      </section>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Login;"],"names":["email","setEmail","useState","password","setPassword","error","setError","show","setShow","handleClose","modalMessage","setModalMessage","getDeviceInfo","deviceDetector","DeviceDetector","userAgent","navigator","device","parse","deviceType","type","os","name","osVersion","version","browser","client","browserVersion","_jsx","_Fragment","children","_jsxs","className","src","require","alt","loading","Link","to","concat","value","onChange","e","target","onClick","async","preventDefault","deviceInfo","res","axios","post","API_URL","data","token","localStorage","setItem","id","img","window","location","href","err","console","response","status","Modal","onHide","Header","Title","Body","Footer","Button","style","backgroundColor","border","textAlign"],"sourceRoot":""}