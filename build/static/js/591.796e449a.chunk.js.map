{"version":3,"file":"static/js/591.796e449a.chunk.js","mappings":"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","sources":["Pages/MyCourses.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport { UserContext } from \"../UserContext\";\r\nimport { API_URL } from \"../App\";\r\n\r\nfunction MyCourses() {\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n  const [searchResults, setSearchResults] = useState([]);\r\n  const [courses, setCourses] = useState([]);\r\n  const navigate = useNavigate();\r\n  const { user } = useContext(UserContext);\r\n  const userId = user.userId;\r\n  const [courseId, setCourseId] = useState(null);\r\n  const [department, setDepartment] = useState([]);\r\n  const [selectedDepartment, setSelectedDepartment] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    const fetchCourses = async () => {\r\n      try {\r\n        const response = await axios.get(\r\n          `${API_URL}/PaymentsCourse/getApprovedCoursesForUser/${userId}`\r\n        );\r\n        setCourses(response.data);\r\n        setSearchResults(response.data);\r\n        if (response.data.length > 0) {\r\n          setCourseId(response.data[0].course_id);\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error fetching approved courses:\", error);\r\n      }\r\n    };\r\n\r\n    fetchCourses();\r\n  }, [userId]);\r\n\r\n  useEffect(() => {\r\n    const fetchCourses = async () => {\r\n      try {\r\n        const response = await axios.get(\r\n          `${API_URL}/PaymentsCourse/getApprovedCoursesForUser/${userId}`\r\n        );\r\n        const fetchedCourses = response.data;\r\n\r\n        // Fetch additional data (student count and lesson count) for each course\r\n        const coursesWithDetails = await Promise.all(\r\n          fetchedCourses.map(async (course) => {\r\n            try {\r\n              const studentCountResponse = await axios.get(\r\n                `${API_URL}/Courses/users-counts/${course.course_id}`\r\n              );\r\n\r\n              const lessonCountResponse = await axios.get(\r\n                `${API_URL}/Courses/lesson-counts/${course.course_id}`\r\n              );\r\n\r\n              // Ensure we access the lesson_count correctly from the response\r\n              const lessonCountData = lessonCountResponse.data;\r\n              const lessonCount =\r\n                Array.isArray(lessonCountData) && lessonCountData.length > 0\r\n                  ? lessonCountData[0].lesson_count\r\n                  : 0;\r\n\r\n              return {\r\n                ...course,\r\n                student_count: studentCountResponse.data?.student_count || 0,\r\n                lesson_count: lessonCount || 0,\r\n              };\r\n            } catch (error) {\r\n              console.error(\r\n                `Error fetching data for course ${course.course_id}:`,\r\n                error\r\n              );\r\n              return {\r\n                ...course,\r\n                student_count: 0,\r\n                lesson_count: 0,\r\n              };\r\n            }\r\n          })\r\n        );\r\n\r\n        setCourses(coursesWithDetails);\r\n        setSearchResults(coursesWithDetails);\r\n      } catch (error) {\r\n        console.error(\"Error fetching approved courses:\", error);\r\n      }\r\n    };\r\n\r\n    fetchCourses();\r\n  }, [userId]);\r\n\r\n  useEffect(() => {\r\n    const fetchDepartments = async () => {\r\n      try {\r\n        const response = await axios.get(\r\n          `${API_URL}/departments/getDepartments`\r\n        );\r\n        setDepartment(response.data);\r\n      } catch (error) {\r\n        console.error(\"Error fetching departments:\", error);\r\n      }\r\n    };\r\n\r\n    fetchDepartments();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const filterCourses = () => {\r\n      let filteredCourses = courses;\r\n\r\n      // Filter by search query\r\n      if (searchQuery) {\r\n        filteredCourses = filteredCourses.filter((course) =>\r\n          course.subject_name.toLowerCase().includes(searchQuery.toLowerCase())\r\n        );\r\n      }\r\n\r\n      // Filter by selected department\r\n      if (selectedDepartment) {\r\n        filteredCourses = filteredCourses.filter(\r\n          (course) => course.department_id === parseInt(selectedDepartment)\r\n        );\r\n      }\r\n\r\n      setSearchResults(filteredCourses);\r\n    };\r\n\r\n    filterCourses();\r\n  }, [searchQuery, selectedDepartment]);\r\n\r\n  const handleInputChange = (event) => {\r\n    setSearchQuery(event.target.value);\r\n  };\r\n\r\n  const handleDepartment = (e) => {\r\n    setSelectedDepartment(e.target.value);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* background image */}\r\n      <div className=\"slide-item\">\r\n        <img\r\n          src={require(\"../assets/corsee.webp\")}\r\n          alt={`Contact Video`}\r\n          className=\"img_home\"\r\n          loading=\"lazy\"\r\n        />\r\n        <div className=\"overlay\">\r\n          <div className=\"overlay-content\">\r\n            <h1 style={{ fontWeight: \"700\", fontSize: \"64px\" }}>دوراتي</h1>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      {/* End background image */}\r\n\r\n      <section className=\"margin_section\">\r\n        <div className=\"container \">\r\n          <div className=\"row \">\r\n            <div className=\"col-lg-3 col-md-4 col-sm-12\">\r\n              <div className=\"navbar__search\">\r\n                <span>\r\n                  <i\r\n                    className=\"fa-solid fa-magnifying-glass fa-sm\"\r\n                    style={{ color: \"#833988\" }}\r\n                  ></i>{\" \"}\r\n                </span>\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"ابحث عن مادة\"\r\n                  value={searchQuery}\r\n                  className=\"search_course\"\r\n                  onChange={handleInputChange}\r\n                />\r\n                <a href=\"#\" className=\"btn btn-s purple_btn search_btn\">\r\n                  بحث{\" \"}\r\n                </a>\r\n              </div>\r\n            </div>\r\n            <div className=\"col-lg-3 col-md-4 col-sm-12\">\r\n              <select\r\n                name=\"department\"\r\n                value={selectedDepartment}\r\n                onChange={handleDepartment}\r\n                id=\"lang\"\r\n                className=\"select_dep\"\r\n              >\r\n                <option value=\"\">اختر قسم</option>\r\n                {department.map((dep) => (\r\n                  <option key={dep.id} value={dep.id}>\r\n                    {dep.title}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n            <div className=\"col-lg-6 col-md-4 col-sm-12\"></div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      <div className=\"container\">\r\n        <div className=\"row d-flex flex-wrap justify-content-center align-items-center\">\r\n          {searchResults.map((course, index) => (\r\n            <div className=\"col-lg-4 col-md-6 col-sm-12\" key={index}>\r\n              <Link\r\n                style={{ textDecoration: \"none\" }}\r\n                to={`/mycoursedetails/${course.course_id}`}\r\n              >\r\n                <div className=\"card card_cont\">\r\n                  <img\r\n                    src={`https://res.cloudinary.com/durjqlivi/${course.course?.img}`}\r\n                    className=\"card-img-top img-fluid card_img\"\r\n                    alt={course.course?.subject_name}\r\n                    loading=\"lazy\"\r\n                  />\r\n                  <div className=\"card-body\">\r\n                    <div>\r\n                      <p className=\"card-text card_dep\">\r\n                        {course.course?.Department?.title ||\r\n                          \"No Department Available\"}\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"d-flex justify-content-between\">\r\n                      <p className=\"course_title_card\">\r\n                        {course.course?.subject_name}\r\n                      </p>\r\n                      <p className=\"teacher_name_card\">\r\n                        {course.course?.teacher?.teacher_name}\r\n                      </p>\r\n                    </div>\r\n                    <hr style={{ marginTop: \"1px\" }} />\r\n                    <div className=\"d-flex justify-content-between\">\r\n                      <i\r\n                        className=\"fa-solid fa-file card_icon\"\r\n                        style={{ color: \"#F57D20\" }}\r\n                      ></i>\r\n                      <p className=\"details_courses_card\">\r\n                        {course.student_count} طالب\r\n                      </p>\r\n                      <i\r\n                        className=\"fa-solid fa-graduation-cap card_icon\"\r\n                        style={{ color: \"#F57D20\" }}\r\n                      ></i>{\" \"}\r\n                      <p className=\"details_courses_card\">\r\n                        {course.lesson_count} درس\r\n                      </p>\r\n                      <i\r\n                        className=\"fa-solid fa-clock card_icon\"\r\n                        style={{ color: \"#F57D20\" }}\r\n                      ></i>{\" \"}\r\n                      <p className=\"details_courses_card\">\r\n                        {new Date(\r\n                          course.course?.created_at\r\n                        ).toLocaleDateString()}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </Link>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MyCourses;\r\n"],"names":["searchQuery","setSearchQuery","useState","searchResults","setSearchResults","courses","setCourses","user","useNavigate","useContext","UserContext","userId","courseId","setCourseId","department","setDepartment","selectedDepartment","setSelectedDepartment","useEffect","async","response","axios","get","concat","API_URL","data","length","course_id","error","console","fetchCourses","fetchedCourses","coursesWithDetails","Promise","all","map","_studentCountResponse","studentCountResponse","course","lessonCountData","lessonCount","Array","isArray","lesson_count","student_count","fetchDepartments","filterCourses","filteredCourses","filter","subject_name","toLowerCase","includes","department_id","parseInt","_jsxs","_Fragment","children","className","_jsx","src","require","alt","loading","style","fontWeight","fontSize","color","type","placeholder","value","onChange","event","target","href","name","e","id","dep","title","index","_course$course","_course$course2","_course$course3","_course$course3$Depar","_course$course4","_course$course5","_course$course5$teach","_course$course6","Link","textDecoration","to","img","Department","teacher","teacher_name","marginTop","Date","created_at","toLocaleDateString"],"sourceRoot":""}