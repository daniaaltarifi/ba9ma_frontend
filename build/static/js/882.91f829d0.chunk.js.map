{"version":3,"file":"static/js/882.91f829d0.chunk.js","mappings":"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","sources":["Pages/Profile.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useContext } from 'react';\r\nimport axios from 'axios';\r\nimport \"../Css/auth.css\";\r\nimport { UserContext } from '../UserContext';\r\nimport { API_URL } from '../App';\r\n\r\nfunction Profile() {\r\n  const [successMessage, setSuccessMessage] = useState('');\r\n  const {user,updateUser}=useContext(UserContext)\r\n  const { userId } = user;\r\n  const [profile, setProfile] = useState({\r\n    name: '',\r\n    email: '',\r\n    img: '',\r\n    password: '',\r\n    confirmPassword: '',\r\n  });\r\n\r\n  const [imageUrl, setImageUrl] = useState(null); // Initialize with defaultImage\r\n\r\n  const fileInputRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if (user.userId) {\r\n      axios.get(`${API_URL}/profile/getProfileUsers/${user.userId}`)\r\n        .then(response => {\r\n          setProfile({\r\n            name: response.data.name,\r\n            email: response.data.email,\r\n            img: response.data.img,\r\n            password: '',\r\n            confirmPassword: ''\r\n          });\r\n          // Set the image URL from the profile data\r\n          setImageUrl(`https://res.cloudinary.com/durjqlivi/${response.data.img}`);\r\n        })\r\n        .catch(error => {\r\n          console.error('There was an error fetching the profile!', error);\r\n        });\r\n    }\r\n  }, [user.userId]);\r\n\r\n  const handleInputChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setProfile(prevState => ({\r\n      ...prevState,\r\n      [name]: value\r\n    }));\r\n  };\r\n\r\n\r\nconst handleUpdate = async () => {\r\n  const formData = new FormData();\r\n  formData.append('name', profile.name);\r\n  formData.append('email', profile.email);\r\n  formData.append('password', profile.password);\r\n  formData.append('confirmPassword', profile.confirmPassword);\r\n  // formData.append('img', profile.img);\r\n  \r\n  if (profile.img instanceof File) {\r\n    formData.append('img', profile.img);\r\n  }\r\n\r\n  try {\r\n    const response = await axios.put(`${API_URL}/profile/updateProfile/${user.userId}`, formData, {\r\n      headers: {\r\n        'Content-Type': 'multipart/form-data'\r\n      }\r\n    });\r\n    // Update the image URL with the new image URL from the server\r\n      setImageUrl(`https://res.cloudinary.com/durjqlivi/${response.data.img}`);\r\nsetSuccessMessage('تم تعديل حسابك');\r\n    updateUser(profile.name,userId,response.data.img)\r\nsetProfile(prevState => ({\r\n...prevState,\r\nname: response.data.name,\r\nimg: response.data.img,\r\n}));\r\n} catch (error) {\r\nconsole.error('Error updating profile:', error);\r\n}\r\n};\r\n  const handleFileChange = (event) => {\r\n    const file = event.target.files[0];\r\n    if (file) {\r\n      // Set the profile image file\r\n      setProfile(prevProfile => ({\r\n        ...prevProfile,\r\n        img: file\r\n      }));\r\n      const objectUrl = URL.createObjectURL(file);\r\n      setImageUrl(objectUrl);\r\n\r\n      // Clean up the object URL when component unmounts\r\n      return () => URL.revokeObjectURL(objectUrl);\r\n    }\r\n    \r\n  };\r\n\r\n  const handleButtonClick = () => {\r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.click();\r\n    }\r\n  };\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    handleUpdate();\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <section className=\"margin_section\">\r\n        <div className=\"container text-center\">\r\n          <div className=\"row\">\r\n            <div className=\"col-lg-3 col-md-4 col-sm-12 \">\r\n              <p className=\"profile_title\">حسابي</p>\r\n              <button className=\"img_profile\" onClick={handleButtonClick}>\r\n                <img\r\n                  src={imageUrl}\r\n                  alt=\"profile\"\r\n                  className=\"img-fluid\"\r\n                  loading=\"lazy\"\r\n                />\r\n              </button>\r\n              <input\r\n                type=\"file\"\r\n                name='img'\r\n                ref={fileInputRef}\r\n                style={{ display: 'none' }}\r\n                onChange={handleFileChange}\r\n              />\r\n            </div>\r\n            <div className=\"col-lg-9 col-md-8 col-sm-12\">\r\n              <div className=\"row m-5\">\r\n                <div className=\"col-lg-6 col-md-12 col-sm-12\">\r\n                  <p className=\"title_of_input_auth\">الاسم</p>\r\n                  <input\r\n                    type=\"text\"\r\n                    className=\"search_blog\"\r\n                    name=\"name\"\r\n                    value={profile.name}\r\n                    onChange={handleInputChange}\r\n                  />\r\n                </div>\r\n                <div className=\"col-lg-6 col-md-12 col-sm-12\">\r\n                  <p className=\"title_of_input_auth\">البريد الالكتروني</p>\r\n                  <input\r\n                    type=\"text\"\r\n                    className=\"search_blog\"\r\n                    name=\"email\"\r\n                    value={profile.email}\r\n                    onChange={handleInputChange}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"row m-5\">\r\n                <div className=\"col-lg-6 col-md-12 col-sm-12\">\r\n                  <p className=\"title_of_input_auth\">كلمة المرور</p>\r\n                  <input\r\n                    type=\"password\"\r\n                    className=\"search_blog\"\r\n                    name=\"password\"\r\n                    value={profile.password}\r\n                    onChange={handleInputChange}\r\n                  />\r\n                </div>\r\n                <div className=\"col-lg-6 col-md-12 col-sm-12 \">\r\n                  <p className=\"title_of_input_auth\">تأكيد كلمة المرور</p>\r\n                  <input\r\n                    type=\"password\"\r\n                    className=\"search_blog\"\r\n                    name=\"confirmPassword\"\r\n                    value={profile.confirmPassword}\r\n                    onChange={handleInputChange}\r\n                  />\r\n                </div>\r\n              </div>\r\n              {successMessage && <p className=\"success_message\">{successMessage}</p>}\r\n              <button type=\"button\" className=\"btn purple_btn mb-2 px-5\" onClick={handleSubmit}>حفظ</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Profile;"],"names":["successMessage","setSuccessMessage","useState","user","updateUser","useContext","UserContext","userId","profile","setProfile","name","email","img","password","confirmPassword","imageUrl","setImageUrl","fileInputRef","useRef","useEffect","axios","get","concat","API_URL","then","response","data","catch","error","console","handleInputChange","e","value","target","prevState","_jsx","_Fragment","children","className","_jsxs","onClick","handleButtonClick","current","click","src","alt","loading","type","ref","style","display","onChange","event","file","files","prevProfile","objectUrl","URL","createObjectURL","revokeObjectURL","preventDefault","async","formData","FormData","append","File","put","headers","handleUpdate"],"sourceRoot":""}